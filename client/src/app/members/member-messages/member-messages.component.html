<section class="inbox-gradient">
  <div class="container py-5">
    <div class="row">
      <div class="col-md-12 col-lg-12 col-xl-12">
        <ul class="list-unstyled text-white">
          @if(this.messageService.messageThread().length === 0) {
          <h4 class="text-light text-center mb-4">No Messages yet</h4>
          } @else { @for(message of this.messageService.messageThread(); track
          message.id) {

          <!---RECIEVER SECTION-->

          @if(message.senderUsername === this.receiverUsername()){
          <div class="col-9">
            <li class="d-flex mb-4">
              <img
                src="{{ message.senderPhotoUrl || './assets/user.png' }}"
                alt="inbox-member-photo"
                class="rounded-circle d-flex align-self-start me-3 shadow-1-strong"
                width="60"
              />
              <div class="card mask-custom">
                <div
                  class="card-header d-flex justify-content-between p-3"
                  style="border-bottom: 1px solid rgb(0, 0, 0)"
                >
                  <p class="text-light mb-0">{{ message.senderUsername }}</p>
                  <p class="text-light small mb-0">
                    <i class="far fa-clock"></i>
                    {{ message.messageSent | timeago }}
                  </p>
                </div>
                <div class="card-body">
                  <span class="text-light mb-0 me-4">
                    {{ message.content }}
                  </span>
                  <i
                    class="fas fa-check-double"
                    [ngClass]="{
                      'text-success': message.messageReadAt,
                      'text-muted': !message.messageReadAt
                    }"
                  ></i>
                </div>
              </div>
            </li>
          </div>
          } @else {
          <!-- SENDER SECTION -->
          <div class="col-8 ms-auto text-end">
            <li class="d-flex mb-4">
              <div class="card mask-custom w-100">
                <div
                  class="card-header d-flex justify-content-between p-3"
                  style="border-bottom: 1px solid rgb(0, 0, 0)"
                >
                  <p class="text-light mb-0">{{ message.senderUsername }}</p>
                  <p class="text-light small mb-0">
                    <i class="far fa-clock"></i>
                    {{ message.messageSent | timeago }}
                  </p>
                </div>
                <div class="card-body">
                  <span class="text-light mb-0 me-4">{{
                    message.content
                  }}</span>
                  <i
                    class="fas fa-check-double"
                    [ngClass]="{
                      'text-success': message.messageReadAt,
                      'text-muted': !message.messageReadAt
                    }"
                  ></i>
                </div>
              </div>
              <img
                src="{{ message.senderPhotoUrl || './assets/user.png' }}"
                alt="inbox-member-photo"
                class="rounded-circle d-flex align-self-start ms-3 shadow-1-strong"
                width="60"
              />
            </li>
          </div>
          } } }
        </ul>
        <!--------    Message Text Box -------------->
        <div class="card-footer mb-0">
          <form #messageForm="ngForm" (ngSubmit)="sendNewMessage()">
            <div class="input-group">
              <input
                type="text"
                required
                name="messageBody"
                [(ngModel)]="messageBody"
                class="form-control input-sm"
                placeholder="Send your message !!"
              />
              <button
                class="btn btn-primary ms-2"
                [disabled]="!messageForm.valid"
                type="submit"
              >
                <i
                  class="fa fa-solid fa-paper-plane"
                  style="color: chartreuse"
                ></i>
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</section>
